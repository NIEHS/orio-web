{% extends "base.html" %}

{% block title %}ORIO | Manual{% endblock %}


{% block mid_content %}

<h1>ORIO</h1>

<p>ORIO (Online Resource for Integrative Omics) is an analysis platform for data from next generation sequencing (NGS). ORIO enables rapid analysis and integration of NGS data sets.  ORIO was designed based on three central observations:</p>

<ol>
<li>Diverse biological phenomena may be represented by discrete positions in genomic space.  Think protein binding sites for transcription factor regulation or transcription start sites for transcription initiation.</li>
<li>Despite a wide diversity of NGS experiment and data types, analysis of NGS data often involves consideration and manipulation of genomic read coverage.</li>
<li>Visual inspection remains a critical component of analysis.</li>
</ol>

<h2>Main functions</h2>

<p>An ORIO analysis run consists of two steps.  First, the intersections between a feature list of genomic coordinates and a number of NGS data sets is performed.  Second, the NGS data sets are correlated based on these intersection values. The output of these steps may be dynamically visualized using ORIO-web.</p>

<p><img src="{{STATIC_URL}}img/orio_doc.png" alt="" title=""></p>

<h3>matrix.py</h3>

<p>matrix.py finds the intersection of a feature list of genomic coordinates and a NGS data set.  This intersection describes the overlap of read coverage from the NGS data across genomic windows anchored on feature list positions.</p>

<p><img src="{{STATIC_URL}}img/matrix_py_doc.png" alt="" title=""></p>

<p><code>
python matrix.py [OPTIONS] BIGWIGS FEATURE_BED OUTPUT_MATRIX
</code></p>

<h5>Required arguments</h5>

<h6>BIGWIGS</h6>

<p>matrix.py requires read coverage of a NGS data set in bigWig format. matrix.py calls bigWigAverageOverBed from the UCSC kentUtils package.  If the <code>--stranded_bigwgs</code> flag is set, two bigWig files are required.  The first bigWig file must correspond to read coverage on the 'plus' strand; the second must correspond to the 'minus' strand.  If the <code>--stranded_bigwigs</code> flag is not used, a single bigWig file is required</p>

<h6>FEATURE_BED</h6>

<p>Genomic windows are generated about entries in a standard BED file.  If the <code>--stranded_bed</code> flag is used, the BED file must have at least six columns per entry.</p>

<h5>Optional arguments</h5>

<h6>-a, --anchor [start|end|center]</h6>

<h6>-b, --bin_start INTEGER (Default: -2500)</h6>

<h6>-n, --bin_number INTEGER (Default: 50)</h6>

<h6>-s, --bin_size INTEGER (Default: 100)</h6>

<p>anchor, bin<em>start, bin</em>number, and bin_size are used to specify the genomic windows created about each genomic feature in the input BED file.  </p>

<p>anchor sets anchor point for each BED range at range start, end, or center, observing entry strandedness ('start' is taken as the highest value of the range for entries on the 'minus' strand).  </p>

<p>bin_start specifies where the genomic window starts; negative values place the starting position upstream.</p>

<p>bin_number specifies the number of bins used in the genomic window.  These bins are considered during generation of output matrix files.</p>

<p>bin_size specifies the size of each bin.  Currently, bins must be the same size.</p>

<h6>--opposite<em>strand</em>fn FILENAME</h6>

<p>If specified, read coverage values for the opposite strand of BED entries are used to generate a separate opposite-strand matrix file.  This file uses the same bins and windows as the 'same-strand' OUTPUT_MATRIX.</p>

<h6>--stranded_bigwigs</h6>

<p>If specified, strand-specific read coverage bigWigs are expected.</p>

<h6>--stranded_bed</h6>

<p>If specified, a stranded BED file is expected.  The output matrix file is then generated informed by strand.  In these stranded matrix files, more downstream positions are represented by higher positive values.</p>

<h5>Output</h5>

<h6>OUTPUT_MATRIX</h6>

<p>The output matrix file gives read coverage over features in the FEATURE<em>BED file considering coverage in the input BIGWIGS file(s). Coverage is reported in bins set by the user-defined parameters.  The first line of OUTPUT</em>MATRIX is a header describing the bins.  The positions given for each bin are relative to the anchor point set by <code>-a, --anchor</code>.  Each row of the matrix corresponds to an individual feature in FEATURE_BED.  Read coverage values are reported as sums in each bin.  In a strand-specific analysis, read coverage in the opposite strand may be found using <code>--opposite_strand_fn FILENAME</code>.</p>

<h3>matrixByMatrix.py</h3>

<p>Considering matrix files generated by <code>matrix.py</code>, <code>matrixByMatrix.py</code> finds correlation values between NGS data sets.  <code>matrixByMatrix.py</code> clusters NGS data sets on the basis of these correlation values. Clustering is also performed on genomic features based on relative enrichment of individual NGS data sets.</p>

<p><img src="{{STATIC_URL}}img/matrixByMatrix_py_doc.png" alt="" title=""></p>

<p><code>
python matrixByMatrix.py [OPTIONS] MATRIX_LIST_FN WINDOW_START BIN_NUMBER BIN_SIZE OUTPUT_JSON
</code></p>

<h5>Required arguments</h5>

<h6>MATRIX<em>LIST</em>FN</h6>

<p>The matrix files generated by <code>matrix.py</code> to be analyzed by <code>matrixByMatrix.py</code> are described in  tab-delimited file <code>MATRIX_LIST_FN</code>.  Each row in the file corresponds to an individual matrix file.  In each row, the following information is given in order: <br>
<code>
MATRIX_ID    DISPLAY_NAME    FILE_PATH
</code></p>

<p><code>FILE_PATH</code> gives the path to the associated matrix file. <code>MATRIX_ID</code> and <code>DISPLAY_NAME</code> are principally used to annotate the <code>OUTPUT_JSON</code> for visualization in <code>ORIO-web</code>.</p>

<h6>WINDOW_START</h6>

<h6>BIN_NUMBER</h6>

<h6>BIN_SIZE</h6>

<p><code>WINDOW_START</code>, <code>BIN_NUMBER</code>, AND <code>BIN_SIZE</code> specify the dimensions of the genomic window used in creating the read coverage matrix files.  These values should be consistent with the parameters used with <code>matrix.py</code>.</p>

<h6>OUTPUT_JSON</h6>

<p>Results of the clustering analysis are reported in <code>OUTPUT_JSON</code>.  These results are designed for visualization in <code>ORIO-web</code>.</p>

<h5>Optional arguments</h5>

<h6>--sort<em>vector SORT</em>VECTOR_FN</h6>

<p>If a sort vector is specified by <code>--sort_vector</code>, correlations are considering a user-defined sort vector.  The sort vector provides an individual value for each genomic feature and has the following format:</p>

<p><code>
FEATURE_ENTRY   ENTRY_VALUE
</code></p>

<p>When a sort vector is used, <code>matrixByMatrix.py</code> finds the pairwise correlations between the sort vector and each matrix file specified in <code>MATRIX_LIST_FN</code>.  Correlation values are found between sort vector values and read coverage sums in each bin.  These correlation values are then used to hierarchically cluster NGS data sets.</p>

<!--
## Auxiliary functions

`ORIO` contains a number of validator functions that are implemented in `ORIO-web`.  These scripts check the formatting of input files and make sure that analysis parameters are consistent with the associated genomic assembly. -->

<h1>ORIO-web</h1>

<p><code>ORIO-web</code> is a web application designed to maintain and organize data for analysis by <code>ORIO</code>.  <code>ORIO-web</code> also provides dynamic visualization of <code>ORIO</code> results.  Together <code>ORIO</code> and <code>ORIO-web</code> allow for fast, flexible, and informative integration of whole-genome data with an intuitive web interface.</p>

<h3>Account management</h3>

<p>The <code>ORIO-web</code> landing page asks a user to generate an account associated with an email address.  All data and analyses managed by <code>ORIO-web</code> are associated with a user account.  Most data is privately associated with a user account; however, <code>ORIO-web</code> does allow individual analyses to designated as public, allowing for rapid sharing of results by URL address.  </p>

<h3>Data types</h3>

<p><code>ORIO_web</code> manages inputs for the <code>ORIO</code> analysis package.  Feature lists, NGS data sets, and sort vectors are associated with a given user account.</p>

<h3>Data management</h3>

<p>Data management controls are found by clicking on the 'Manage data' link button.  On the 'Data management' page, headers designate the 'Feature lists', 'Sort vectors', and 'User dataset' sections.  Data may be deleted or modified by clicking on entries under each header, or new entries may be created by clicking on 'Create new' buttons.</p>

<p>When creating new entries, each data type requires a name, an associated genome assembly, and correctly formatted data set.  Feature lists may be specified as stranded; if so, strand must be specified for each entry in the associated BED file in the sixth column.  Sort vectors must be associated with an existing feature list, and that feature list must be specified upon creation.</p>

<p>NGS data sets are uploaded to the tool as read coverage bigWig files.  Given the large size of these files, we require these files to be hosted by user and be publicly accessible by HTTP download.  When creating a data set entry, the user must provide a valid URL for HTTP access.</p>

<h3>Analysis</h3>

<p>Completed and pending analyses are presented on the <code>ORIO-web</code> dashboard.</p>

<h4>Analysis management</h4>

<h5>Create analysis</h5>

<p>An analysis can be created by clicking on the 'Proceed to run setup' button.  An analysis requires a name, genome assembly, and feature list.  Upon selecting a genome assembly, drop-down menus for feature list, sort vector, and user-uploaded data sets are populated.  Also upon selecting a genomic assembly, ENCODE data selection fields will be populated.  ENCODE data selection was designed to navigate through the diverse data generated by the ENCODE project.  Fields such as 'Data type', 'Cell type', and 'Antibody' may be used to quickly filter down all ENCODE data sets to a list passing filter criteria.  The user may then select individual data from this filter list.</p>

<h5>Execute analysis</h5>

<p>After all fields and options are specified, the analysis may be saved.  Upon saving, the analysis will be subject to a validation step.  Following validation, the analysis may be started by clicking the 'Execute' button on the analysis page.  Upon completion of analysis, a message will be sent by email to the user.</p>

<h5>Modify existing analysis</h5>

<p>An analysis may be modified from the dashboard by clicking on a completed or pending analysis and selecting 'Update' from the 'Actions' drop-down on the analysis page.  From there, the analysis parameters may be modified.  An analysis may also be deleted by selecting 'Delete' from the 'Actions' drop-down menu and confirming the selection.</p>

<h4>Analysis visualization</h4>

<p><code>ORIO-web</code> provides an intuitive interface for investigating analysis results.  The visualization interface may be accessed for a completed analysis by selecting that analysis on the dashboard and clicking 'View visualization' on the analysis page.  The results of an <code>ORIO</code> analysis may also be downloaded as a zip file by selecting 'Download zip' from the 'Actions' drop-down on an analysis page.</p>

<h5>Data set clustering</h5>

<h6>Without a sort vector</h6>

<p>Data sets were hierarchically clustered based on Spearman rho values. Clustering results are shown as a dendrogram on the left side of the top panel. Rho values are reported by color in an <em>n</em>-by-<em>n</em> heatmap, where <em>n</em> is the number of data sets.  Rho values may also be found in tooltips when hovering over individual cells.  By clicking on a cell, a scatterplot will be generated showing the points used to derive the Spearman rho value.  A drop-down menu allows for individual values to be investigated on a bin-by-bin basis.</p>

<p>In the bottom panel, individual data sets may be selected in the list on the left.  Once selected, the bar plot on the right will be populated with pairwise Spearman correlation values for each other data set.  After clicking on ‘Display individual heatmap’, a window will pop up detailing the read coverage for that data set over the feature list.</p>

<p>In the pop up, a heatmap of read coverage over the user-specified genomic window is shown on the right. In the upper-left panel, a plot of bin-average read coverage is shown.  In the mid-left panel, a plot of bin-average read coverage over quartiles is shown.  Quartiles are generated respecting the sort order of the read coverage heatmap.  The sort order of heatmap may be changed using the lower-left panel.  By selecting a data set and clicking ‘Reorder heatmap’ the heatmap will be re-ordered to reflect read coverage of the selected data set in descending order, ie genomic features with greater read coverage in the selected data set will be on top.  The quartile plot will change upon re-ordering of the read coverage heatmap.  The p-value in the upper-left corner of the quartile plot is derived from application of the four-sample Anderson-Darling test to the quartile plots and reflects the null hypothesis that quartiles are sampled from populations that are identical.</p>

<h6>With a sort vector</h6>

<p>Data sets were hierarchically clustered.  For each data set, the read coverage sum across each bin found.  Then, for each given bin, the Spearman rho value is found between the bin read coverage sums and the sort vector.  For each data set, these correlation values are concatenated in a single data vector.  The data sets are hierarchically clustered using the pairwise Euclidean distance between each data set.  Rho values are displayed by color gradient in a <em>n</em>-by-<em>m</em> heatmap, where <em>n</em> is the number of data sets and <em>m</em> is the number of genomic bins.  By clicking on a cell, a scatterplot will be generated showing the points used to the derive the Spearman rho value.</p>

<p>In the bottom panel, individual data sets may be selected in the list on the left.  Once selected, the bar plot on the right will be populated with Spearman correlation values for each genomic bin.  After clicking on ‘Display individual heatmap’, a window will pop up detailing the read coverage for that data set over the feature list.</p>

<p>In the pop up, a heatmap of read coverage over the user-specified genomic window is shown on the right. In the upper-left panel, a plot of bin-average read coverage is shown.  In the mid-left panel, a plot of bin-average read coverage over quartiles is shown.  Quartiles are generated respecting the sort order of the read coverage heatmap.  The sort order of heatmap may be changed using the lower-left panel.  By selecting a data set and clicking ‘Reorder heatmap’ the heatmap will be re-ordered to reflect read coverage of the selected data set in descending order, i.e. genomic features with greater read coverage in the selected data set will be on top.  The quartile plot will change upon re-ordering of the read coverage heatmap.  The p-value in the upper-left corner of the quartile plot is derived from application of the four-sample Anderson-Darling test to the quartile plots and reflects the null hypothesis that quartiles are sampled from populations that are identical.</p>

<h5>Feature clustering</h5>

<p>Genomic features are clustered using <em>k</em>-means clustering. For each genomic feature, sum of the read coverage for each data set is found. These sums are then normalized such that each value is in terms of units variance. These normalized sums are concatenated into data vectors for each genomic feature. <em>k</em>-means clustering is then performed on these data vectors.  Centroids are initialized by randomly selecting individual data vectors. <em>k</em>-means clustering is iteratively performed for <em>k</em> values 2 to 10.</p>

<p>In the 'Feature clustering' view, clustering results are shown on the heatmap in the right panel.  Here, each row corresponds to a genomic feature, and each column corresponds to a data set. In each cell, the color represents the read coverage at a genomic feature for a data set after upper-quartile normalization.  Columns are ordered based on hierarchical clustering results with a dendrogram at the top of the panel. Bars on the left side of the panel reflect cluster membership.</p>

<p>In the left panel, <em>k</em> values may be selected from a drop-down list.  Members of the selected cluster are displayed in a list at the bottom of the left panel.  If selected, a genomic feature will be indicated in the heatmap by a black arrow.  Also, the values of the selected genomic feature will be displayed on the centroid chart in the bottom panel.</p>

<p>In the bottom panel, a two-dimensional plot displays read coverage values for cluster centroids. Values are upper-quartile normalized.  If a genomic feature is selected in the upper panel, read coverage values for that feature will be plot as a black line.</p>

{% endblock mid_content %}
